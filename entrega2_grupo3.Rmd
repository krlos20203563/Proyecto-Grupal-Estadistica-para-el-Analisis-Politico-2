---
title: 'Borrador'
author: "Carlos Crespín"
date: "2022-10-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Regresiones: Carlos Daniel Crespín Juárez - 20203563

```{r}
library("rio")
library("dplyr")
```

```{r}
poverty=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/Poverty.xls")
```
```{r}
poverty=select(poverty, c(1, 63))
```

```{r}
poverty=filter(poverty, !is.na(...63))
```

```{r}
names(poverty)=c("Country", "Porcentpobreza2018")
```

```{r}
poverty=poverty[-c(1),]
```

```{r}
poverty$Porcentpobreza2018=as.numeric(poverty$Porcentpobreza2018)
```

```{r}
str(poverty)
```

```{r}
GINI=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/GINI.csv")
```

```{r}
str(GINI)
```
```{r}
names(GINI)
```
```{r}
GINI=select(GINI, c(1, 3))
```

```{r}
names(GINI)=c("Country", "IndexGINI")
```

```{r}
Desempleo=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/TDESEMPLEO.xls")
```
```{r}
Desempleo=select(Desempleo, c(1,63))
```

```{r}
Desempleo=filter(Desempleo, !is.na(...63))
```

```{r}
names(Desempleo)=c("Country", "PobUnemp2018")
```

```{r}
Desempleo=Desempleo[-c(1),]
```

```{r}
names(Desempleo)
```
```{r}
Desempleo$PobUnemp2018=as.numeric(Desempleo$PobUnemp2018)
```

```{r}
str(Desempleo)
```
```{r}
massmov=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/mmALL.csv")
```

```{r}
massmov=select(massmov, c(2, 4, 7))
```

```{r}
str(massmov)
```
```{r}
massmov=filter(massmov, year>2018 & year<2020)
```

```{r}
massmov=massmov[-c(1:4, 6, 8:21, 25:28, 30:32, 34:40, 43:47, 51:54, 56:67, 71:81, 83, 85:86, 88:100, 103:116, 118, 121:151, 153:157, 160:164, 167:193, 195:196, 198:213, 215, 217:219, 221:224, 226:230, 232:238, 240:241, 243:247, 249:264, 267:284, 286:289, 291:293, 295:301, 303:304, 307:310, 312:313, 315, 318:320, 322:334, 340:341, 343, 345, 349:350, 355:357, 361:366, 369:394, 399:408, 410, 412:414, 419:422, 424:440, 446:455, 457:460, 462:463, 471, 477:485, 487:498, 500:502, 507:509, 511:513, 515:516, 519:524, 526:590, 592:594, 597:623, 625:628, 631:648, 650:652, 655:715, 728, 731:734, 736:790, 792, 796, 799:820, 823:824, 826:829, 831:838, 840:842, 844:846, 848:850, 857, 859:863),]
```

```{r}
str(massmov)
```
```{r}
massmov$protestnumber=as.numeric(massmov$protestnumber)
```

```{r}
str(massmov)
```
```{r}
massmov$year=as.numeric(massmov$year)
```

```{r}
str(massmov)
```
```{r}
summary(massmov$protestnumber)
```
```{r}
massmov=select(massmov, c(1, 3))
```

```{r}
names(massmov)=c("Country", "protestnumber2019")
```



```{r}
library(stargazer)
```
```{r}
library(knitr)
```

```{r}
protestas1=left_join(poverty, massmov)
str(protestas1)
```
```{r}
protestas1=filter(protestas1, !is.na(protestnumber2019))
```

```{r}
protestas2=left_join(Desempleo, massmov)
str(protestas2)
```
```{r}
protestas2=filter(protestas2, !is.na(protestnumber2019))
```

```{r}
protestas3=left_join(GINI, massmov)
str(protestas3)
```
```{r}
protestas3=filter(protestas3, !is.na(protestnumber2019))
```

```{r}
summary(protestas1$protestnumber2019)
```
```{r}
summary(protestas2$protestnumber2019)
```
```{r}
summary(protestas3$protestnumber2019)
```
```{r}
var(protestas1$protestnumber2019)
```
```{r}
var(protestas2$protestnumber2019)
```
```{r}
var(protestas3$protestnumber2019)
```
En este caso, en las 3 bases de datos hay sobredispersión, puesto que la varianza es mayor a la media en todos los casos
```{r}
modelo1=glm(protestnumber2019~Porcentpobreza2018, family = poisson(link = "log"), data = protestas1)
summary(modelo1)
```
```{r}
overdispersion=AER::dispersiontest(modelo1,alternative='greater')$ p.value<0.05
underdispersion=AER::dispersiontest(modelo1,alternative='less')$ p.value<0.05
testResult=as.data.frame(rbind(overdispersion,underdispersion))
names(testResult)='Es probable?'
testResult
```
```{r}
modelo2=glm(protestnumber2019~PobUnemp2018, family = poisson(link = "log"), data = protestas2)
summary(modelo2)
```
```{r}
overdispersion=AER::dispersiontest(modelo2,alternative='greater')$ p.value<0.05
underdispersion=AER::dispersiontest(modelo2,alternative='less')$ p.value<0.05
testResult=as.data.frame(rbind(overdispersion,underdispersion))
names(testResult)='Es probable?'
testResult
```
```{r}
modelo3=glm(protestnumber2019~IndexGINI, family = poisson(link = "log"), data = protestas3)
summary(modelo3)
```
```{r}
overdispersion=AER::dispersiontest(modelo3,alternative='greater')$ p.value<0.05
underdispersion=AER::dispersiontest(modelo3,alternative='less')$ p.value<0.05
testResult=as.data.frame(rbind(overdispersion,underdispersion))
names(testResult)='Es probable?'
testResult
```
Como se pudo observar mediante la prueba, en los 3 modelos existe sobredispersión. En ese sentido, se realizará una regresión quasipoisson
```{r}
rq1=glm(protestnumber2019~Porcentpobreza2018, family = quasipoisson(link = "log"), data = protestas1)
summary(rq1)
```
```{r}
rq2=glm(protestnumber2019~PobUnemp2018, family = quasipoisson(link = "log"), data = protestas2)
summary(rq2)
```
```{r}
rq3=glm(protestnumber2019~IndexGINI, family = quasipoisson(link = "log"), data = protestas3)
summary(rq3)
```
```{r}
library(modelsummary)
```

Supuestos

```{r}
par(mfrow = c(2, 2))  
plot(rq1, 1,caption = '');title(main="Linealidad")
plot(rq1, 2, caption = '');title(main="Normalidad")
plot(rq1, 3, caption = '');title(main="Homocedasticidad")
plot(rq1, 5, caption = '');title(main="Influyentes")
```
```{r}
par(mfrow = c(2, 2))  
plot(rq2, 1,caption = '');title(main="Linealidad")
plot(rq2, 2, caption = '');title(main="Normalidad")
plot(rq2, 3, caption = '');title(main="Homocedasticidad")
plot(rq2, 5, caption = '');title(main="Influyentes")
```
```{r}
par(mfrow = c(2, 2))  
plot(rq3, 1,caption = '');title(main="Linealidad")
plot(rq3, 2, caption = '');title(main="Normalidad")
plot(rq3, 3, caption = '');title(main="Homocedasticidad")
plot(rq3, 5, caption = '');title(main="Influyentes")
```

Regresiones: Kevin Oscar Villareal Urquizo
**Limpieza de la variable Salario mensual promedio**

```{r}
Salariomensual=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/Salariomensual.xlsx")
```
```{r}
library(dplyr)
Salariomensual=select(Salariomensual, c(1, 3, 5, 6))
```

Filtrar filas

```{r}
names(Salariomensual)=c("Country", "Sex", "Time", "Dolar")
```


```{r}
filter(Salariomensual, Sex=="Total" & Time<2020)

datos1=filter(Salariomensual, Sex=="Total"& Time<2020)

filter(datos1, Time>="2014")

datos2=filter(datos1, Time>="2014")

datos2=datos2[-c(1:5,7:9,11:15,17,18,20:24,26:30,32,35,36:39,41:45,48,50:54,56,57,60:71,74:76,81:85,89:93,95:99,101:105,107:111,113,115:119,122:125,127:131,133:136,138:142,144:148,150,152:156,158:162,165:169,171,173:177,179:183,187,189:192,194,195,197:201,203:207,209,211:215,217:219,221:225,228:230,232:235,239:243,246:251,255:259,261:265,268:272,276:279,281:284,287:291,293:297,299:303,306:308,311:315,319:323,325:328,330:334,336:340,342:346,348,349,351:355,357:361,363:367,369,370,372,375,377:381,384:388,390:394,396:400,402,404:408,410:414,417:421,423:427,430:434,437,440:444,448:452,454:458,460:464,466:470,472,473,475), ]
```

Exploración de la variable

```{r}
class(Salariomensual$Dolar)
summary(Salariomensual$Dolar)
```
```{r}
library(rio)
massmov=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/mmALL.csv")

library(dplyr)
massmov=select(massmov, c(2, 4, 7))

str(massmov)

massmov=filter(massmov, year>2018 & year<2020)

massmov=massmov[-c(1:4, 6, 8:21, 25:28, 30:32, 34:40, 43:47, 51:54, 56:67, 71:81, 83, 85:86, 88:100, 103:116, 118, 121:151, 153:157, 160:164, 167:193, 195:196, 198:213, 215, 217:219, 221:224, 226:230, 232:238, 240:241, 243:247, 249:264, 267:284, 286:289, 291:293, 295:301, 303:304, 307:310, 312:313, 315, 318:320, 322:334, 340:341, 343, 345, 349:350, 355:357, 361:366, 369:394, 399:408, 410, 412:414, 419:422, 424:440, 446:455, 457:460, 462:463, 471, 477:485, 487:498, 500:502, 507:509, 511:513, 515:516, 519:524, 526:590, 592:594, 597:623, 625:628, 631:648, 650:652, 655:715, 728, 731:734, 736:790, 792, 796, 799:820, 823:824, 826:829, 831:838, 840:842, 844:846, 848:850, 857, 859:863),]
```
Calidad de democracia electoral (Debido al extenso tamaño del archivo, este no se puede subir a Git-hub)



```{r}
getwd()
```
```{r}
V_Dem=import("V-Dem-CY-Core-v12 (1).csv")
```




```{r}
caldemo=filter(V_Dem, year>2018 & year<2020)

select(caldemo, country_name, v2x_polyarchy)
caldemo=select(caldemo, country_name, v2x_polyarchy)
```
PBI per capita

```{r}
PBI=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/PBIpercapita.xls")


PBI=select(PBI, c(1, 64))



PBI=filter(PBI, !is.na(...64))



names(PBI)=c("Country", "PBIpercapita2019")



PBI=PBI[-c(1),]



PBI=filter(PBI, !is.na(Country))

PBI$PBIpercapita2019 = as.numeric(PBI$PBIpercapita2019)
str(PBI$PBIpercapita2019)
```
```{r}
caldemo$Country=as.factor(caldemo$country_name)


caldemo$country_name=NULL
massmov$country=NULL
```

```{r}
DataACAP=merge(PBI,caldemo,all.x=T,all.y=T)
```


```{r}
DataACAP[duplicated(DataACAP$Country),]
```
```{r}
DataACAP[!complete.cases(DataACAP),]
```
```{r}
data_fdr=merge(DataACAP,Salariomensual,all.x=T,all.y=T)

```
```{r}
data_protest=merge(data_fdr,massmov,all.x=T,all.y=T)


```


```{r}
class(data_protest$PBIpercapita2019)
class(data_protest$Dolar)
class(data_protest$v2x_polyarchy)
```

Regresión de Poisson entre el indice de democracia electoral (v2x_polyarchy), PBI per capita y salario promedio en dolares (dolar)

```{r}
library(stargazer)

h1=formula(protestnumber~PBIpercapita2019 + v2x_polyarchy + Dolar)

```

```{r}
stargazer(modelo1,type = "text",intercept.bottom = FALSE,style="all2")
```
Podemos observar que tanto la variable PBI per capita así como salario promedio en dólares no poseen un impacto en el número de protestas que se efectúan por año. No obstante, el impacto del índice de democracia electoral es negativo y estadísticamente significativa sobre la posibilidad de que se den un mayor número de protestas.

Lo que podemos concluir del modelo de regresión de Poisson es que la posibilidad de que disminuya el número de protestas por año conforme aumente el índice de calidad de la democracia electoral es de un 805%, por lo que podemos afirmar que el número de protestas que se encuentran registradas por el Mass Mobilization Data Proyect se vinculan a la insatisfacción de demandas en torno a la calidad de su democracia en términos electorales.


Regresiones: Cristhian Andrew Silvera Solano

```{r}
library(rio)
Inflapconsum=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/Inflapconsum.xls")
```



```{r}
Inflapconsum[!complete.cases(Inflapconsum),]
```




```{r}
IDH=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/IDH.xlsx")
```

```{r}
Inflapconsum[!complete.cases(Inflapconsum),]
```



```{r}
IDH[!complete.cases(IDH),]
```




```{r}
corrupcion=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/CPI2019.xlsx")
```

```{r}
corrupcion[!complete.cases(corrupcion),]
```

```{r}
library(dplyr)
corrupcion=select(corrupcion, c(1, ...4,...5))
```


```{r}
names(corrupcion)= c("country","CPI","rank")
```

```{r}
corrupcion=corrupcion[-c(1,2),]
```

inflapconsum

```{r}
Inflapconsum=select(Inflapconsum, c(1, ...3,...63))
```

```{r}
names(Inflapconsum)=c("country","indicador", "year")
```

```{r}
Inflapconsum=Inflapconsum[-c(1,2),]
```

```{r}
Inflapconsum=filter(Inflapconsum, !is.na(country))
```

```{r}
Inflapconsum=filter(Inflapconsum, !is.na(2018))
```


```{r}
Inflapconsum=Inflapconsum[-c(6,9,11,26,27,38,43,46,50,52,69,78,84,91,93108,110,132,137,147,149,155,164,172,179,192,193,199,212,213,220,225,227,228,234,235,245,252,254,255,256,262),]
```



```{r}
str(IDH)
```


IDH
```{r}
IDH=select(IDH, c(2, ...3))
```

```{r}
names(IDH)=c("country","IDH")
```

```{r}
IDH=IDH[-c(1,2,3,4,5,6,7),]
```

```{r}
IDH=filter(IDH, !is.na(IDH))
```

```{r}
IDH=IDH[-c(192,193,194,195,196,197,198,199,200,207,208,209,210),]
```



```{r}
massmov=import("https://github.com/krlos20203563/Proyecto-Grupal-Estadistica-para-el-Analisis-Politico-2/raw/main/mmALL.csv")
```

```{r}
massmov=select(massmov, c(2, 4, 7))
```

```{r}
massmov=filter(massmov, year>2018 & year<2020)
```

```{r}
massmov=massmov[-c(1:4, 6, 8:21, 25:28, 30:32, 34:40, 43:47, 51:54, 56:67, 71:81, 83, 85:86, 88:100, 103:116, 118, 121:151, 153:157, 160:164, 167:193, 195:196, 198:213, 215, 217:219, 221:224, 226:230, 232:238, 240:241, 243:247, 249:264, 267:284, 286:289, 291:293, 295:301, 303:304, 307:310, 312:313, 315, 318:320, 322:334, 340:341, 343, 345, 349:350, 355:357, 361:366, 369:394, 399:408, 410, 412:414, 419:422, 424:440, 446:455, 457:460, 462:463, 471, 477:485, 487:498, 500:502, 507:509, 511:513, 515:516, 519:524, 526:590, 592:594, 597:623, 625:628, 631:648, 650:652, 655:715, 728, 731:734, 736:790, 792, 796, 799:820, 823:824, 826:829, 831:838, 840:842, 844:846, 848:850, 857, 859:863),]
```


```{r}
base1=merge(massmov,IDH)
```

```{r}
base2=merge(massmov,Inflapconsum)
```

```{r}
base3=merge(corrupcion,massmov)
```

```{r}
str(base1)
```

```{r}
str(base3)
```





```{r}
base1$protestnumber = as.numeric(base1$protestnumber)
base1$IDH = as.numeric(base1$IDH)
base3$year  = as.numeric(base3$year)
base3$CPI = as.numeric(base3$CPI)
base3$protestnumber = as.numeric(base3$protestnumber)
```


regresion base 1

```{r}
regresion1=formula(protestnumber~IDH,family = poisson(link = "log"))
library(stargazer)
reg1=glm(regresion1,data=base1)
summary(reg1)
```
En esta regresión, se puede observar que el IDH no es una variable significativa para explicar el número de protestas por año en cada país


regresion base 3 

```{r}
regresion2=formula(protestnumber~CPI,family = poisson(link = "log"))
library(stargazer)
reg2=glm(regresion2,data=base3)
summary(reg2)
```































































































































































